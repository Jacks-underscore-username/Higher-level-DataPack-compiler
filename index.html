<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monaco Editor with VSCode Theme</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.49.0/min/vs/loader.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script>
        require.config({
            paths: {
                'jszip': 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min'
            }
        })
        require(['jszip'], JSZip => {
            window.JSZip = JSZip
        })
    </script>
    <script>
        //Saves some value to localStorage, with nonexistent path error handling.
        const save = (keyPath, value) => {
            const data = JSON.parse(localStorage.getItem('saveData') ?? '{}')
            keyPath = keyPath.split('.')
            let lastObject = data
            while (keyPath.length > 1) {
                const key = keyPath.splice(0, 1)[0]
                if (typeof lastObject[key] !== 'object')
                    lastObject[key] = {}
                lastObject = lastObject[key]
            }
            lastObject[keyPath[0]] = value
            localStorage.setItem('saveData', JSON.stringify(data))
        }

        //Loads some value from localStorage, with nonexistent path error handling.
        const load = keyPath => {
            const data = JSON.parse(localStorage.getItem('saveData') ?? '{}')
            keyPath = keyPath.split('.')
            let lastObject = data
            while (keyPath.length > 1)
                lastObject = lastObject[keyPath.splice(0, 1)[0]] ?? {}
            return lastObject[keyPath[0]]
        }

        //Removes some value from localStorage, with nonexistent path error handling.
        const forget = keyPath => {
            const data = JSON.parse(localStorage.getItem('saveData') ?? '{}')
            keyPath = keyPath.split('.')
            let lastObject = data
            while (keyPath.length > 1) {
                const key = keyPath.splice(0, 1)[0]
                if (typeof lastObject[key] !== 'object')
                    lastObject[key] = {}
                lastObject = lastObject[key]
            }
            delete lastObject[keyPath[0]]
            localStorage.setItem('saveData', JSON.stringify(data))
        }
    </script>
    <script type="module" src="script.js"></script>
</head>

<body>
    <div id="wrapper">
        <div id="editor-wrapper" class="pane" data-name="editor">
            <div id="editor-color-patch-highlight"></div>
            <div id="editor-color-patch-border"></div>
            <div class="pane-titlebar">
                <div class="pane-titlebar-icon-bar">
                    <div class="pane-titlebar-icon pane-titlebar-icon-hue">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 32.5-156t88-127Q256-817 330-848.5T488-880q80 0 151 27.5t124.5 76q53.5 48.5 85 115T880-518q0 115-70 176.5T640-280h-74q-9 0-12.5 5t-3.5 11q0 12 15 34.5t15 51.5q0 50-27.5 74T480-80Zm0-400Zm-220 40q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120-160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm200 0q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120 160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17ZM480-160q9 0 14.5-5t5.5-13q0-14-15-33t-15-57q0-42 29-67t71-25h70q66 0 113-38.5T800-518q0-121-92.5-201.5T488-800q-136 0-232 93t-96 227q0 133 93.5 226.5T480-160Z" />
                        </svg>
                    </div>
                    <div class="pane-titlebar-icon pane-titlebar-icon-border">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M280-120v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80ZM120-120v-720h720v80H200v640h-80Z" />
                        </svg>
                    </div>
                </div>
                <div class="pane-titlebar-title">Editor</div>
            </div>
            <div class="pane-option-hue pane-option">
                <div class="pane-option-remember" data-name="hue">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <input type="range" class="pane-option-hue-slider" min="0" max="360" value="0">
            </div>
            <div class="pane-option-border pane-option">
                <div class="pane-option-remember" data-name="border">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <div class="pane-option-border-toggle">
                    <div>Show border:</div>
                    <svg class="pane-option-border-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-border-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
            </div>
            <div id="editor">
                <div id="editor-title"></div>
                <div id="editor-content"></div>
            </div>
        </div>
        <div id="explorer" class="pane" data-name="explorer">
            <div class="pane-titlebar">
                <div class="pane-titlebar-icon-bar">
                    <div class="pane-titlebar-icon pane-titlebar-icon-hue">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 32.5-156t88-127Q256-817 330-848.5T488-880q80 0 151 27.5t124.5 76q53.5 48.5 85 115T880-518q0 115-70 176.5T640-280h-74q-9 0-12.5 5t-3.5 11q0 12 15 34.5t15 51.5q0 50-27.5 74T480-80Zm0-400Zm-220 40q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120-160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm200 0q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120 160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17ZM480-160q9 0 14.5-5t5.5-13q0-14-15-33t-15-57q0-42 29-67t71-25h70q66 0 113-38.5T800-518q0-121-92.5-201.5T488-800q-136 0-232 93t-96 227q0 133 93.5 226.5T480-160Z" />
                        </svg>
                    </div>
                    <div class="pane-titlebar-icon pane-titlebar-icon-border">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M280-120v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80ZM120-120v-720h720v80H200v640h-80Z" />
                        </svg>
                    </div>
                </div>
                <div class="pane-titlebar-title">Explorer</div>
            </div>
            <div class="pane-option-hue pane-option">
                <div class="pane-option-remember" data-name="hue">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <input type="range" class="pane-option-hue-slider" min="0" max="360" value="0">
            </div>
            <div class="pane-option-border pane-option">
                <div class="pane-option-remember" data-name="border">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <div class="pane-option-border-toggle">
                    <div>Show border:</div>
                    <svg class="pane-option-border-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-border-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
            </div>
            <div id="explorer-content"></div>
        </div>
        <div id="controls" class="pane" data-name="controls">
            <div class="pane-titlebar">
                <div class="pane-titlebar-icon-bar">
                    <div class="pane-titlebar-icon pane-titlebar-icon-hue">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 32.5-156t88-127Q256-817 330-848.5T488-880q80 0 151 27.5t124.5 76q53.5 48.5 85 115T880-518q0 115-70 176.5T640-280h-74q-9 0-12.5 5t-3.5 11q0 12 15 34.5t15 51.5q0 50-27.5 74T480-80Zm0-400Zm-220 40q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120-160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm200 0q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120 160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17ZM480-160q9 0 14.5-5t5.5-13q0-14-15-33t-15-57q0-42 29-67t71-25h70q66 0 113-38.5T800-518q0-121-92.5-201.5T488-800q-136 0-232 93t-96 227q0 133 93.5 226.5T480-160Z" />
                        </svg>
                    </div>
                    <div class="pane-titlebar-icon pane-titlebar-icon-border">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M280-120v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80ZM120-120v-720h720v80H200v640h-80Z" />
                        </svg>
                    </div>
                </div>
                <div class="pane-titlebar-title">Controls</div>
            </div>
            <div class="pane-option-hue pane-option">
                <div class="pane-option-remember" data-name="hue">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <input type="range" class="pane-option-hue-slider" min="0" max="360" value="0">
            </div>
            <div class="pane-option-border pane-option">
                <div class="pane-option-remember" data-name="border">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <div class="pane-option-border-toggle">
                    <div>Show border:</div>
                    <svg class="pane-option-border-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-border-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
            </div>
            <div id="controls-content">
                <div class="controls-section">
                    <div class="controls-section-title">General</div>
                    <div class="controls-section-content" id="controls-name-wrapper">
                        <label for="controls-packName">Datapack name</label>
                        <input id="controls-packName" type="text" placeholder="My custom datapack">
                        <input id="controls-packPrefix" type="text" placeholder="myCustomDatapack">
                        <label for="controls-packPrefix">Datapack prefix</label>
                        <script>
                            {
                                const nameInput = document.getElementById('controls-packName')
                                const prefixInput = document.getElementById('controls-packPrefix')
                                const originalPlaceholder = prefixInput.placeholder
                                nameInput.addEventListener('input', event => {
                                    const value = event.target.value.replace(/[^a-z0-9 ._-]|^\s+$/gi, () => '')
                                    nameInput.value = value
                                    save('packName', value)
                                    const placeholder = value.replace(/[0-9._-]/g, () => ' ').replace(/\s+/g, () => '  ').split(' ').reduce((prev, item, index) => index ? `${prev}${item.slice(0, 1).toUpperCase()}${item.slice(1).toLowerCase()}` : item.toLowerCase(), '')
                                    prefixInput.placeholder = placeholder === '' ? originalPlaceholder : placeholder
                                })
                                if (load('packName') !== undefined) {
                                    nameInput.value = load('packName')
                                    nameInput.dispatchEvent(new Event('input'))
                                }
                                if (load('packPrefix') !== undefined)
                                    prefixInput.value = load('packPrefix')
                                prefixInput.addEventListener('input', event => {
                                    const value = event.target.value.replace(/[^a-z]|^\s+$/gi, () => '')
                                    prefixInput.value = value
                                    save('packPrefix', value)
                                })
                            }
                        </script>
                    </div>
                </div>
                <div class="controls-section">
                    <div class="controls-section-title">Folder</div>
                    <div class="controls-section-content">
                        <div id="controls-functionLocation-wrapper">
                            <legend>Function file location mode</legend>
                            <button id="controls-functionLocation-flat">Flat</button>
                            <button id="controls-functionLocation-layered">Layered</button>
                            <script>
                                document.addEventListener('DOMContentLoaded', () => {
                                    const wrapper = document.getElementById('controls-functionLocation-wrapper')
                                    const flat = wrapper.children[1]
                                    const layered = wrapper.children[2]
                                    if (load('functionLocation') === 'layered')
                                        layered.classList.add('selected')
                                    else
                                        flat.classList.add('selected')
                                    layered.addEventListener('click', () => {
                                        layered.classList.add('selected')
                                        flat.classList.remove('selected')
                                        save('functionLocation', 'layered')
                                    })
                                    flat.addEventListener('click', () => {
                                        layered.classList.remove('selected')
                                        flat.classList.add('selected')
                                        save('functionLocation', 'flat')
                                    })
                                })
                            </script>
                        </div>
                        <div id="controls-writeToLocalFolder-wrapper" class="checkbox-wrapper">
                            <div>Write to local folder:</div>
                            <svg class="icon-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path
                                    d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                            </svg>
                            <svg class="icon-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path
                                    d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                            </svg>
                        </div>
                        <div id="controls-folderLocation-selector">
                            <button id="controls-folderLocation-button">Select folder</button>
                            <div id="controls-folderLocation-current">Current: <code>unset</code></div>
                            <script>
                                let filesystemHandle, filesystemPermission
                                {
                                    const currentTitle = document.getElementById('controls-folderLocation-current')
                                    document.getElementById('controls-folderLocation-button').addEventListener('click', async () => {
                                        try {
                                            filesystemHandle = await window.showDirectoryPicker()
                                            filesystemPermission = await filesystemHandle.requestPermission({ mode: 'readwrite' })
                                            currentTitle.innerHTML = `Current: <code>${filesystemHandle.name}</code>`
                                            currentTitle.classList.add('selected')
                                        }
                                        catch (err) { }
                                    })

                                    const wrapper = document.getElementById('controls-folderLocation-selector')
                                    const selector = document.getElementById('controls-folderLocation-selector')

                                    const check = document.getElementById('controls-writeToLocalFolder-wrapper')
                                    if (load('writeToLocalFolder')) {
                                        check.classList.add('on')
                                        selector.classList.add('show')
                                    }
                                    else
                                        check.classList.add('off')
                                    check.addEventListener('click', () => {
                                        check.classList.toggle('on')
                                        check.classList.toggle('off')
                                        selector.classList.toggle('show')
                                        save('writeToLocalFolder', check.classList.contains('on'))
                                    })
                                }
                            </script>
                        </div>
                        <div id="controls-autoExpandFolders-wrapper" class="checkbox-wrapper">
                            <div>Auto expand folders:</div>
                            <svg class="icon-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path
                                    d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                            </svg>
                            <svg class="icon-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path
                                    d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                            </svg>
                            <script>
                                {
                                    const check = document.getElementById('controls-autoExpandFolders-wrapper')
                                    if (load('autoExpandFolders') === false)
                                        check.classList.add('off')
                                    else
                                        check.classList.add('on')
                                    check.addEventListener('click', () => {
                                        check.classList.toggle('on')
                                        check.classList.toggle('off')
                                        save('autoExpandFolders', check.classList.contains('on'))
                                    })
                                }
                            </script>
                        </div>
                    </div>
                </div>
                <div class="controls-section">
                    <div class="controls-section-title">Generate</div>
                    <div class="controls-section-content">
                        <button id="generatePack">Generate datapack</button>
                        <br>
                        <button id="downloadPack">Download datapack</button>
                        <div id="controls-autoGenerateFolder-wrapper" class="checkbox-wrapper">
                            <div>Auto generate folder:</div>
                            <svg class="icon-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path
                                    d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                            </svg>
                            <svg class="icon-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path
                                    d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                            </svg>
                            <script>
                                {
                                    const element = document.getElementById('controls-autoGenerateFolder-wrapper')
                                    if (load('autoGenerateFolder'))
                                        element.classList.add('on')
                                    else
                                        element.classList.add('off')
                                    element.addEventListener('click', () => {
                                        element.classList.toggle('on')
                                        element.classList.toggle('off')
                                        save('autoGenerateFolder', element.classList.contains('on'))
                                    })
                                }
                            </script>
                        </div>

                    </div>
                </div>
                <script>
                    for (const wrapper of [...document.getElementsByClassName('controls-section')]) {
                        const content = wrapper.children[1]
                        wrapper.children[0].addEventListener('click', () => {
                            if (!wrapper.classList.contains('closed')) {
                                content.style.height = `${Math.ceil(content.getBoundingClientRect().height)}px`
                                content.getBoundingClientRect() //If I don't call this the animation breaks.
                            }
                            wrapper.classList.toggle('closed')
                        })
                        content.addEventListener('transitionend', () => {
                            if (!wrapper.classList.contains('closed'))
                                content.style.height = 'auto'
                        })
                    }
                </script>
            </div>
        </div>
        <div id="docs" class="pane" data-name="docs">
            <div class="pane-titlebar">
                <div class="pane-titlebar-icon-bar">
                    <div class="pane-titlebar-icon pane-titlebar-icon-hue">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 32.5-156t88-127Q256-817 330-848.5T488-880q80 0 151 27.5t124.5 76q53.5 48.5 85 115T880-518q0 115-70 176.5T640-280h-74q-9 0-12.5 5t-3.5 11q0 12 15 34.5t15 51.5q0 50-27.5 74T480-80Zm0-400Zm-220 40q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120-160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm200 0q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm120 160q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17ZM480-160q9 0 14.5-5t5.5-13q0-14-15-33t-15-57q0-42 29-67t71-25h70q66 0 113-38.5T800-518q0-121-92.5-201.5T488-800q-136 0-232 93t-96 227q0 133 93.5 226.5T480-160Z" />
                        </svg>
                    </div>
                    <div class="pane-titlebar-icon pane-titlebar-icon-border">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                            <path
                                d="M280-120v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80ZM120-120v-720h720v80H200v640h-80Z" />
                        </svg>
                    </div>
                </div>
                <div class="pane-titlebar-title">Documentation</div>
            </div>
            <div class="pane-option-hue pane-option">
                <div class="pane-option-remember" data-name="hue">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <input type="range" class="pane-option-hue-slider" min="0" max="360" value="0">
            </div>
            <div class="pane-option-border pane-option">
                <div class="pane-option-remember" data-name="border">
                    <div>Remember:</div>
                    <svg class="pane-option-remember-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-remember-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
                <div class="pane-option-border-toggle">
                    <div>Show border:</div>
                    <svg class="pane-option-border-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="m424-312 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z" />
                    </svg>
                    <svg class="pane-option-border-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z" />
                    </svg>
                </div>
            </div>
            <div style="color:var(--highlight); font-size: xx-large;">
                Coming soon...
            </div>
        </div>
        <script>
            const lastMouse = { x: undefined, y: undefined }
            {
                document.addEventListener('mousemove', event => {
                    lastMouse.x = event.clientX
                    lastMouse.y = event.clientY
                })

                const hueStart = Math.random() * 360
                Array.from(document.getElementsByClassName('pane')).forEach((element, index) => {
                    element.parentElement.style.setProperty(`--pane-${element.getAttribute('data-name')}-hue`, (hueStart + index * 90) % 360)
                    element.style.setProperty('--hue', (hueStart + index * 90) % 360)

                    const updateScale = scale => {
                        element.style.zoom = scale
                        save(`${element.getAttribute('data-name')}-scale`, scale)
                    }

                    updateScale(load(`${element.getAttribute('data-name')}-scale`) ?? 1)

                    const scaleScale = [.25, .33, .5, .67, .75, .8, .9, 1, 1.1, 1.25, 1.5, 1.75, 2, 2.5, 3, 4, 5]
                    document.addEventListener('keydown', event => {
                        const lastScale = load(`${element.getAttribute('data-name')}-scale`)
                        const rect = element.getBoundingClientRect()
                        if (event.ctrlKey && event.altKey && ['0', '-', '='].includes(event.key) && lastMouse.x >= rect.left * lastScale && lastMouse.x <= rect.right * lastScale && lastMouse.y >= rect.top * lastScale && lastMouse.y <= rect.bottom * lastScale) {
                            event.preventDefault()
                            if (event.key === '0')
                                updateScale(1)
                            else {
                                const scale = scaleScale[Math.min(scaleScale.length - 1, Math.max(0, scaleScale.indexOf(load(`${element.getAttribute('data-name')}-scale`)) + (event.key === '-' ? -1 : 1)))]
                                updateScale(scale)
                            }
                        }
                    })
                })

                Array.from(document.getElementsByClassName('pane-titlebar-icon-hue')).forEach(element => element.addEventListener('click', () => {
                    element.classList.toggle('open')
                    element.parentElement.parentElement.parentElement.getElementsByClassName('pane-option-hue')[0].classList.toggle('open')
                }))

                Array.from(document.getElementsByClassName('pane-titlebar-icon-border')).forEach(element => element.addEventListener('click', () => {
                    element.classList.toggle('open')
                    element.parentElement.parentElement.parentElement.getElementsByClassName('pane-option-border')[0].classList.toggle('open')
                }))

                Array.from(document.getElementsByClassName('pane-option-remember')).forEach(element => {
                    const keyPath = `paneOptions.${element.parentElement.parentElement.getAttribute('data-name')}_${element.getAttribute('data-name')}`
                    if (load(keyPath) !== undefined) {
                        element.classList.add('on')
                        element.setAttribute('data-value', load(keyPath))
                    }
                    else
                        element.classList.add('off')
                    element.addEventListener('click', () => {
                        element.classList.toggle('on')
                        element.classList.toggle('off')
                        if (element.classList.contains('off'))
                            forget(keyPath)
                        else
                            save(keyPath, element.getAttribute('data-value'))
                    })
                    new MutationObserver((mutations) => {
                        mutations.forEach((mutation) => {
                            if (element.classList.contains('on') && mutation.type === 'attributes' && mutation.attributeName === 'data-value')
                                save(keyPath, element.getAttribute('data-value'))
                        })
                    }).observe(element, {
                        attributes: true
                    })
                })

                Array.from(document.getElementsByClassName('pane-option-hue-slider')).forEach(element => {
                    const remember = element.parentElement.getElementsByClassName('pane-option-remember')[0]
                    const pane = element.parentElement.parentElement
                    const wrapper = pane.parentElement
                    if (remember.getAttribute('data-value') !== null) {
                        wrapper.style.setProperty(`--pane-${pane.getAttribute('data-name')}-hue`, remember.getAttribute('data-value'))
                        pane.style.setProperty('--hue', remember.getAttribute('data-value'))
                    }
                    element.addEventListener('input', () => {
                        wrapper.style.setProperty(`--pane-${pane.getAttribute('data-name')}-hue`, element.value)
                        pane.style.setProperty('--hue', element.value)
                        remember.setAttribute('data-value', element.value)
                    })
                    element.value = pane.style.getPropertyValue('--hue')
                    remember.setAttribute('data-value', element.value)
                })

                Array.from(document.getElementsByClassName('pane-option-border-toggle')).forEach(element => {
                    const remember = element.parentElement.getElementsByClassName('pane-option-remember')[0]
                    const pane = element.parentElement.parentElement
                    if (remember.getAttribute('data-value') === 'false')
                        element.classList.add('off')
                    else
                        element.classList.add('on')
                    pane.style.setProperty('--do-border', element.classList.contains('on') + 0)
                    element.addEventListener('click', () => {
                        const state = element.classList.contains('off')
                        remember.setAttribute('data-value', state)
                        pane.style.setProperty('--do-border', state + 0)
                        element.classList.toggle('on')
                        element.classList.toggle('off')
                    })
                })
            }
        </script>
        <div id="fake-resizer-x1">
            <div id="resizer-x" class="resizer"></div>
        </div>
        <div id="fake-resizer-x2"></div>
        <div id="fake-resizer-y">
            <div id="resizer-y" class="resizer"></div>
        </div>
    </div>
</body>

</html>